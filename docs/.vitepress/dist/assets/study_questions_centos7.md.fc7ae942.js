import{_ as s,o as a,c as l,U as n}from"./chunks/framework.3eb667f5.js";const F=JSON.parse('{"title":"Centos7 升级内核版本","description":"","frontmatter":{},"headers":[],"relativePath":"study/questions/centos7.md","lastUpdated":1680934572000}'),e={name:"study/questions/centos7.md"},o=n(`<h1 id="centos7-升级内核版本" tabindex="-1">Centos7 升级内核版本 <a class="header-anchor" href="#centos7-升级内核版本" aria-label="Permalink to &quot;Centos7 升级内核版本&quot;">​</a></h1><h2 id="_1、查看当前内核版本" tabindex="-1">1、查看当前内核版本 <a class="header-anchor" href="#_1、查看当前内核版本" aria-label="Permalink to &quot;1、查看当前内核版本&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uname</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span></span>
<span class="line"><span style="color:#A6ACCD;">3.10.0-1160.el7.x86_64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uname</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-a</span></span>
<span class="line"><span style="color:#FFCB6B;">Linux</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">localhost.localdomain</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">3.10.0-1160.el7.x86_64</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">#1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cat</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/redhat-release</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#FFCB6B;">CentOS</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Linux</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">release</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">7.9.2009</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Core</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_2、升级内核" tabindex="-1">2、升级内核 <a class="header-anchor" href="#_2、升级内核" aria-label="Permalink to &quot;2、升级内核&quot;">​</a></h2><h4 id="更新yum源仓库" tabindex="-1">更新yum源仓库 <a class="header-anchor" href="#更新yum源仓库" aria-label="Permalink to &quot;更新yum源仓库&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-y</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">update</span></span>
<span class="line"></span></code></pre></div><h4 id="启用-elrepo-仓库" tabindex="-1">启用 ELRepo 仓库 <a class="header-anchor" href="#启用-elrepo-仓库" aria-label="Permalink to &quot;启用 ELRepo 仓库&quot;">​</a></h4><p>ELRepo 仓库是基于社区的用于企业级 Linux 仓库，提供对 RedHat Enterprise (RHEL) 和 其他基于 RHEL的 Linux 发行版（CentOS、Scientific、Fedora 等）的支持。 ELRepo 聚焦于和硬件相关的软件包，包括文件系统驱动、显卡驱动、网络驱动、声卡驱动和摄像头驱动等。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">#导入ELRepo仓库的公共密钥</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">rpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--import</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#安装ELRepo仓库的yum源</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#rpm -Uvh https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm</span></span>
<span class="line"></span></code></pre></div><h2 id="_3、查看可用的系统内核包" tabindex="-1">3、查看可用的系统内核包 <a class="header-anchor" href="#_3、查看可用的系统内核包" aria-label="Permalink to &quot;3、查看可用的系统内核包&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--disablerepo=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">elrepo-kernel</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">available</span></span>
<span class="line"><span style="color:#FFCB6B;">Loaded</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">plugins:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">fastestmirror</span></span>
<span class="line"><span style="color:#FFCB6B;">Loading</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">mirror</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">speeds</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cached</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hostfile</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">elrepo-kernel:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">linux-mirrors.fnal.gov</span></span>
<span class="line"><span style="color:#FFCB6B;">elrepo-kernel/primary_db</span><span style="color:#A6ACCD;">                                    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2.0</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">MB</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">00</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">00</span><span style="color:#C3E88D;">:</span><span style="color:#F78C6C;">02</span><span style="color:#A6ACCD;">     </span></span>
<span class="line"><span style="color:#FFCB6B;">可安装的软件包</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt.x86_64</span><span style="color:#A6ACCD;">                         </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-devel.x86_64</span><span style="color:#A6ACCD;">                   </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-doc.noarch</span><span style="color:#A6ACCD;">                     </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-headers.x86_64</span><span style="color:#A6ACCD;">                 </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-tools.x86_64</span><span style="color:#A6ACCD;">                   </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-tools-libs.x86_64</span><span style="color:#A6ACCD;">              </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-tools-libs-devel.x86_64</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">5.4.181-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml.x86_64</span><span style="color:#A6ACCD;">                         </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-devel.x86_64</span><span style="color:#A6ACCD;">                   </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-doc.noarch</span><span style="color:#A6ACCD;">                     </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-headers.x86_64</span><span style="color:#A6ACCD;">                 </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-tools.x86_64</span><span style="color:#A6ACCD;">                   </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-tools-libs.x86_64</span><span style="color:#A6ACCD;">              </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-ml-tools-libs-devel.x86_64</span><span style="color:#A6ACCD;">        </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">perf.x86_64</span><span style="color:#A6ACCD;">                              </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">python-perf.x86_64</span><span style="color:#A6ACCD;">                       </span><span style="color:#C3E88D;">5.16.11-1.el7.elrepo</span><span style="color:#A6ACCD;">         </span><span style="color:#C3E88D;">elrepo-kernel</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="_4、安装最新长期支持版本内核" tabindex="-1">4、安装最新长期支持版本内核 <a class="header-anchor" href="#_4、安装最新长期支持版本内核" aria-label="Permalink to &quot;4、安装最新长期支持版本内核&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">--enablerepo=elrepo-kernel</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">install</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kernel-lt</span></span>
<span class="line"></span></code></pre></div><p>kernel-ml 主线最新版本</p><p><code>--enablerepo</code> 选项开启 CentOS 系统上的指定仓库。默认开启的是 <code>elrepo</code>，这里用 <code>elrepo-kernel</code> 替换。</p><h2 id="_5、设置-grub2" tabindex="-1">5、设置 grub2 <a class="header-anchor" href="#_5、设置-grub2" aria-label="Permalink to &quot;5、设置 grub2&quot;">​</a></h2><p>内核安装好后，需要设置为默认启动选项并重启后才会生效</p><h4 id="查看系统上的所有可用内核" tabindex="-1">查看系统上的所有可用内核： <a class="header-anchor" href="#查看系统上的所有可用内核" aria-label="Permalink to &quot;查看系统上的所有可用内核：&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">awk</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-F</span><span style="color:#A6ACCD;">\\&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">$1==&quot;menuentry &quot; {print i++ &quot; : &quot; $2}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/grub2.cfg</span></span>
<span class="line"><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> : CentOS Linux </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">5.4.181-1.el7.elrepo.x86_64</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Core</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> : CentOS Linux </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">3.10.0-1160.el7.x86_64</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Core</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> : CentOS Linux </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">-rescue-7d2155314bbf7543a1024df4ab69de3a</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">Core</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h4 id="设置新的内核为grub2的默认版本" tabindex="-1">设置新的内核为grub2的默认版本 <a class="header-anchor" href="#设置新的内核为grub2的默认版本" aria-label="Permalink to &quot;设置新的内核为grub2的默认版本&quot;">​</a></h4><p>服务器上存在4 个内核，我们要使用 5.4 这个版本，可以通过 <code>grub2-set-default 0</code> 命令或编辑 <code>/etc/default/grub</code> 文件来设置</p><h4 id="方法1、通过-grub2-set-default-0-命令设置" tabindex="-1">方法1、通过 <code>grub2-set-default 0</code> 命令设置 <a class="header-anchor" href="#方法1、通过-grub2-set-default-0-命令设置" aria-label="Permalink to &quot;方法1、通过 \`grub2-set-default 0\` 命令设置&quot;">​</a></h4><p>其中 0 是上面查询出来的可用内核</p><p><code>grub2-set-default 0</code></p><h4 id="方法2、编辑-etc-default-grub-文件" tabindex="-1">方法2、编辑 <code>/etc/default/grub</code> 文件 <a class="header-anchor" href="#方法2、编辑-etc-default-grub-文件" aria-label="Permalink to &quot;方法2、编辑 \`/etc/default/grub\` 文件&quot;">​</a></h4><p>设置 GRUB_DEFAULT=0，通过上面查询显示的编号为 0 的内核作为默认内核：</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">vim</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/etc/default/grub</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_TIMEOUT</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_DISTRIBUTOR</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;$(</span><span style="color:#FFCB6B;">sed</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s, release .*$,,g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> /etc/system-release</span><span style="color:#89DDFF;">)&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_DEFAULT</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_DISABLE_SUBMENU</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_TERMINAL_OUTPUT</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">console</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_CMDLINE_LINUX</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">crashkernel=auto rd.lvm.lv=cl/root rhgb quiet</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">GRUB_DISABLE_RECOVERY</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h4 id="生成-grub-配置文件并重启" tabindex="-1">生成 grub 配置文件并重启 <a class="header-anchor" href="#生成-grub-配置文件并重启" aria-label="Permalink to &quot;生成 grub 配置文件并重启&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">grub2-mkconfig</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-o</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/grub2/grub.cfg</span></span>
<span class="line"><span style="color:#FFCB6B;">Generating</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">grub</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">configuration</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">file</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">...</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">linux</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/vmlinuz-5.4.181-1.el7.elrepo.x86_64</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">initrd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/initramfs-5.4.181-1.el7.elrepo.x86_64.img</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">linux</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/vmlinuz-3.10.0-1160.el7.x86_64</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">initrd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/initramfs-3.10.0-1160.el7.x86_64.img</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">linux</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/vmlinuz-</span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">-rescue-7d2155314bbf7543a1024df4ab69de3a</span></span>
<span class="line"><span style="color:#FFCB6B;">Found</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">initrd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">image:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/boot/initramfs-</span><span style="color:#F78C6C;">0</span><span style="color:#C3E88D;">-rescue-7d2155314bbf7543a1024df4ab69de3a.img</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">reboot</span></span>
<span class="line"></span></code></pre></div><h2 id="_6、验证" tabindex="-1">6、验证 <a class="header-anchor" href="#_6、验证" aria-label="Permalink to &quot;6、验证&quot;">​</a></h2><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">uname</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span></span>
<span class="line"><span style="color:#A6ACCD;">5.4.181-1.el7.elrepo.x86_64</span></span>
<span class="line"></span></code></pre></div><h2 id="_7、删除旧内核-可选" tabindex="-1">7、删除旧内核（可选） <a class="header-anchor" href="#_7、删除旧内核-可选" aria-label="Permalink to &quot;7、删除旧内核（可选）&quot;">​</a></h2><h4 id="查看系统中全部的内核" tabindex="-1">查看系统中全部的内核： <a class="header-anchor" href="#查看系统中全部的内核" aria-label="Permalink to &quot;查看系统中全部的内核：&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rpm</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-qa</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">grep</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kernel</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-lt-5.4.181-1.el7.elrepo.x86_64</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-tools-libs-3.10.0-1160.el7.x86_64</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-3.10.0-1160.el7.x86_64</span></span>
<span class="line"><span style="color:#FFCB6B;">kernel-tools-3.10.0-1160.el7.x86_64</span></span>
<span class="line"></span></code></pre></div><h4 id="方法1、yum-remove-删除旧内核的-rpm-包" tabindex="-1">方法1、yum remove 删除旧内核的 RPM 包 <a class="header-anchor" href="#方法1、yum-remove-删除旧内核的-rpm-包" aria-label="Permalink to &quot;方法1、yum remove 删除旧内核的 RPM 包&quot;">​</a></h4><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">$</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">yum</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">remove</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kernel-tools-libs-3.10.0-1160.el7.x86_64</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel-3.10.0-1160.el7.x86_64 \\</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel-tools-3.10.0-1160.el7.x86_64</span></span>
<span class="line"></span></code></pre></div><h4 id="方法2、yum-utils-工具" tabindex="-1">方法2、yum-utils 工具 <a class="header-anchor" href="#方法2、yum-utils-工具" aria-label="Permalink to &quot;方法2、yum-utils 工具&quot;">​</a></h4><p>如果安装的内核不多于 3 个，<code>yum-utils</code> 工具不会删除任何一个。只有在安装的内核大于 3 个时，才会自动删除旧内核。</p><p>安装yum-utils</p><p><code>$ yum install yum-utils</code></p><p>删除旧版本</p><p><code>package-cleanup --oldkernels</code></p>`,42),p=[o];function t(r,c,C,y,D,i){return a(),l("div",null,p)}const d=s(e,[["render",t]]);export{F as __pageData,d as default};
