import{_ as s,o as a,c as n,U as e}from"./chunks/framework.3eb667f5.js";const l="/assets/m1.8f6b54dc.webp",o="/assets/m2.a76f8999.webp",t="/assets/m3.c95026c2.webp",q=JSON.parse('{"title":"Centos7重置Mysql8 root 密码","description":"","frontmatter":{},"headers":[],"relativePath":"study/questions/mysql_pass.md","lastUpdated":1683954556000}'),p={name:"study/questions/mysql_pass.md"},r=e('<h1 id="centos7重置mysql8-root-密码" tabindex="-1">Centos7重置Mysql8 root 密码 <a class="header-anchor" href="#centos7重置mysql8-root-密码" aria-label="Permalink to &quot;Centos7重置Mysql8 root 密码&quot;">​</a></h1><p>安装完 最新版的 mysql8后忘记了密码，想重置root密码；找了网上好多资料都不尽相同，根据自己的问题总结如下：</p><h2 id="一、修改配置文件免密码登录mysql" tabindex="-1">一、修改配置文件免密码登录mysql <a class="header-anchor" href="#一、修改配置文件免密码登录mysql" aria-label="Permalink to &quot;一、修改配置文件免密码登录mysql&quot;">​</a></h2><h3 id="_1-1-打开配置文件" tabindex="-1">1.1 打开配置文件 <a class="header-anchor" href="#_1-1-打开配置文件" aria-label="Permalink to &quot;1.1 打开配置文件&quot;">​</a></h3><p><code>vim /etc/my.cnf</code></p><p><img src="'+l+'" alt="m1"></p><h3 id="_1-2-在-mysqld-最后加上如下语句-并保持退出文件" tabindex="-1">1.2 在 [mysqld]最后加上如下语句 并保持退出文件 <a class="header-anchor" href="#_1-2-在-mysqld-最后加上如下语句-并保持退出文件" aria-label="Permalink to &quot;1.2 在 [mysqld]最后加上如下语句 并保持退出文件&quot;">​</a></h3><p><code>skip-grant-tables</code></p><p><img src="'+o+`" alt="m2"></p><h3 id="_1-3-重启mysql服务" tabindex="-1">1.3 重启mysql服务 <a class="header-anchor" href="#_1-3-重启mysql服务" aria-label="Permalink to &quot;1.3 重启mysql服务&quot;">​</a></h3><p><code>service mysqld restart</code></p><h2 id="二、免密登录mysql-直接在命令行上输入" tabindex="-1">二、免密登录mysql，直接在命令行上输入 <a class="header-anchor" href="#二、免密登录mysql-直接在命令行上输入" aria-label="Permalink to &quot;二、免密登录mysql，直接在命令行上输入&quot;">​</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mysql</span></span>
<span class="line"><span style="color:#A6ACCD;">//或者</span></span>
<span class="line"><span style="color:#A6ACCD;">mysql -u root -p </span></span>
<span class="line"><span style="color:#A6ACCD;">//password直接回车</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="三、给root用户重置密码" tabindex="-1">三、给root用户重置密码 <a class="header-anchor" href="#三、给root用户重置密码" aria-label="Permalink to &quot;三、给root用户重置密码&quot;">​</a></h2><h3 id="_3-1首先查看当前root用户相关信息-在mysql数据库的user表中" tabindex="-1">3.1首先查看当前root用户相关信息，在mysql数据库的user表中 <a class="header-anchor" href="#_3-1首先查看当前root用户相关信息-在mysql数据库的user表中" aria-label="Permalink to &quot;3.1首先查看当前root用户相关信息，在mysql数据库的user表中&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> host, user, authentication_string, plugin </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> user;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>host: 允许用户登录的ip‘位置’%表示可以远程；</p><p>user:当前数据库的用户名；</p><p>authentication_string: 用户密码；在mysql 5.7.9以后废弃了password字段和password()函数；</p><p>plugin： 密码加密方式；</p><p><img src="`+t+`" alt="m3"></p><h3 id="_3-2如果当前root用户authentication-string字段下有内容-先将其设置为空" tabindex="-1">3.2如果当前root用户authentication_string字段下有内容，先将其设置为空 <a class="header-anchor" href="#_3-2如果当前root用户authentication-string字段下有内容-先将其设置为空" aria-label="Permalink to &quot;3.2如果当前root用户authentication_string字段下有内容，先将其设置为空&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#A6ACCD;"> mysql;</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> user </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> authentication_string</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-3-退出mysql-删除-etc-my-cnf文件最后的-skip-grant-tables-重启mysql服务" tabindex="-1">3.3 退出mysql, 删除/etc/my.cnf文件最后的 skip-grant-tables 重启mysql服务 <a class="header-anchor" href="#_3-3-退出mysql-删除-etc-my-cnf文件最后的-skip-grant-tables-重启mysql服务" aria-label="Permalink to &quot;3.3 退出mysql, 删除/etc/my.cnf文件最后的 skip-grant-tables 重启mysql服务&quot;">​</a></h3><h3 id="_3-4-使用root用户进行登录-因为上面设置了authentication-string为空-所以可以免密码登录" tabindex="-1">3.4 使用root用户进行登录，因为上面设置了authentication_string为空，所以可以免密码登录 <a class="header-anchor" href="#_3-4-使用root用户进行登录-因为上面设置了authentication-string为空-所以可以免密码登录" aria-label="Permalink to &quot;3.4 使用root用户进行登录，因为上面设置了authentication_string为空，所以可以免密码登录&quot;">​</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mysql -u root -p</span></span>
<span class="line"><span style="color:#A6ACCD;">passwrod:直接回车;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-5使用alter修改root用户密码" tabindex="-1">3.5使用ALTER修改root用户密码 <a class="header-anchor" href="#_3-5使用alter修改root用户密码" aria-label="Permalink to &quot;3.5使用ALTER修改root用户密码&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">user</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> IDENTIFIED </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Qian123#</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>至此修改成功； 重新使用用户名密码登录即可。</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>一定不要采取如下形式改密码：</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#A6ACCD;"> mysql;</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> user </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> authentication_string</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">newpassword</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这样会给user表中root用户的authentication_string字段下设置了newpassword值；</p><p>当再使用ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFITED BY &#39;newpassword&#39;时会报错的；</p><p>因为authentication_string字段下只能是mysql加密后的41位字符串密码；其它的会报格式错误；</p></div>`,30),c=[r];function i(d,y,m,u,h,C){return a(),n("div",null,c)}const D=s(p,[["render",i]]);export{q as __pageData,D as default};
